function experience_list(){"use strict";allExperiences.forEach(function(n){n.title.length<1&&(n.title="[none]");var i=0;n.consumptions.forEach(function(n){n.drug.id===drug.id&&(i+=n.count)});var e=[],t="Solo Experience";n.consumptions.forEach(function(n){n.friends.forEach(function(n){-1===e.indexOf(n.name)&&e.push(n.name)})}),e.length>0&&(t=e.join(", "));var a=[],o="[no location]";n.consumptions.forEach(function(n){-1===a.indexOf(n.location)&&a.push(n.location)}),a.length>0&&(o=a.join(", ")),$("#experienceContainer").append('<li class="collection-item">'+new Date(1e3*n.date).toISOString().slice(0,10)+'<span class="right hide-on-med-and-down" style="max-width: 50%;">'+t+" at <strong>"+o+'</strong></span><h5><a href="/experience.html?'+n.id+'">'+n.title+'</a></h5><div class="pad-left-40">'+i+" "+drug.unit+" "+drug.name+"</div></li>")}),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,drug,allExperiences;analyticsCount+=1;
function hourly(){"use strict";for(var t=[],e=0;23>=e;e+=1)t[e]=0;var n=6e4*(new Date).getTimezoneOffset();allConsumptions.forEach(function(e){var i=new Date(1e3*e.date+n),o=i.getHours();t[o]+=1}),$("#hourly").highcharts({chart:{type:"column"},title:{text:"Consumptions by hour"},xAxis:{categories:["0000 - 0100","0100 - 0200","0200 - 0300","0300 - 0400","0400 - 0500","0500 - 0600","0600 - 0700","0700 - 0800","0800 - 0900","0900 - 1000","1000 - 1100","1100 - 1200","1200 - 1300","1300 - 1400","1400 - 1500","1500 - 1600","1600 - 1700","1700 - 1800","1800 - 1900","1900 - 2000","2000 - 2100","2100 - 2200","2200 - 2300","2300 - 0000"],crosshair:!0},yAxis:{min:0,title:{text:"Consumptions"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}: </span>',pointFormat:"<b>{point.y} consumptions</b>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:drug.name,data:t}]}),setTimeout(function(){$("#hourly").highcharts().reflow()},2e3),analyticsFinished+=1}function daily(){"use strict";for(var t=[],e=0;6>=e;e+=1)t[e]=0;var n=6e4*(new Date).getTimezoneOffset();allConsumptions.forEach(function(e){var i=new Date(1e3*e.date+n),o=i.getDay();t[o]+=1}),$("#daily").highcharts({chart:{type:"column"},title:{text:"Consumptions by Day"},xAxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],crosshair:!0},yAxis:{min:0,title:{text:"Consumptions"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}: </span>',pointFormat:"<b>{point.y} consumptions</b>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:drug.name,data:t}]}),setTimeout(function(){$("#daily").highcharts().reflow()},2e3),analyticsFinished+=1}function hours_days(){"use strict";hourly(),daily()}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,drug;analyticsCount+=2;
function top_listings(){"use strict";var n={};allConsumptions.forEach(function(o){n.hasOwnProperty(o.location)?n[o.location]=n[o.location]+1:n[o.location]=1});var o=Object.keys(n);o.sort(function(o,i){return n[o]>n[i]?-1:n[o]<n[i]?1:0}),o=o.slice(0,10);var i="<ol>"+o.map(function(o){return"<li>"+o+" ("+n[o]+" consumptions/"+Math.round(n[o]/allConsumptions.length*100,-1)+"%)</li>"}).join("")+"</ol>";$("#topLocations").append(i),analyticsFinished+=1;var t={};allConsumptions.forEach(function(n){n.friends.forEach(function(n){t.hasOwnProperty(n.name)?t[n.name]=t[n.name]+1:t[n.name]=1})});var a=Object.keys(t);a.sort(function(n,o){return t[n]>t[o]?-1:t[n]<t[o]?1:0}),a=a.slice(0,10);var s="<ol>"+a.map(function(n){return"<li>"+n+" ("+t[n]+" consumptions)</li>"}).join("")+"</ol>";0===a.length?$("#topFriends").append("<i>None</i>"):$("#topFriends").append(s),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,drug;analyticsCount+=2;
function vitals(){"use strict";allDrugs.sort(function(t,e){return t.use_count<e.use_count?1:t.use_count>e.use_count?-1:0});var t=allDrugs.map(function(t){return t.name}),e=t.indexOf(drug.name),a="";e>0&&(a='preceded by <a href="/analytics.html?'+allDrugs[e-1].id+'">'+t[e-1]+"</a>");var n="";e!==t.length-1&&(n='followed by <a href="/analytics.html?'+allDrugs[e+1].id+'">'+t[e+1]+"</a>");var l=0;allConsumptions.forEach(function(t){t.drug.id===drug.id&&(l+=t.count)});var s;s=a&&n?"("+a+" and "+n+")":a?"("+a+")":n?"("+n+")":"",$("#ranking").html("#"+(e+1)+" by usage with "+allDrugs[e].use_count+" uses/"+l+" "+drug.unit+" <i>"+s+"</i>"),$("#useFirst").html(new Date(1e3*allConsumptions[0].date).toISOString().slice(0,16).replace(/T/," ").replace(":","")+' -- <a href="/experience.html?'+allConsumptions[0].exp_id+'">'+allConsumptions[0].title+"</a>"),$("#useLast").html(new Date(1e3*allConsumptions[allConsumptions.length-1].date).toISOString().slice(0,16).replace(/T/," ").replace(":","")+' -- <a href="/experience.html?'+allConsumptions[allConsumptions.length-1].exp_id+'">'+allConsumptions[allConsumptions.length-1].title+"</a>");var i=JSON.parse(JSON.stringify(allConsumptions));i.sort(function(t,e){return e.count-t.count});var r=i.slice(0,3).map(function(t){return"<li>"+new Date(1e3*t.date).toISOString().slice(0,16).replace(/T/," ").replace(":","")+" -- "+t.count+" "+drug.unit+' -- <a href="/experience.html?'+t.exp_id+'">'+t.title+"</a></li>"});$("#largeDose").html('<ul class="pad-left-40">'+r.join("")+"</ul>");var o=allConsumptions.map(function(t){return Math.floor(new Date(1e3*t.date)/864e5)});o=o.filter(function(t,e){return o.indexOf(t)===e});var u=[],c={};o.forEach(function(t,e){return 0===e?(c.startDate=t,void(c.days=1)):e===o.length-1?void u.push({startDate:c.startDate,days:c.days}):void(t-o[e-1]===1?c.days+=1:(u.push({startDate:c.startDate,days:c.days}),c.startDate=t,c.days=1))}),u.sort(function(t,e){return t.days<e.days?1:t.days>e.days?-1:0}),$("#streak").html(u[0].days+" days <i>(starting on "+new Date(86400*u[0].startDate*1e3).toISOString().slice(0,10)+")</i>");var p,d,m=!1,h=0;allConsumptions.forEach(function(t,e){var a;return e===allConsumptions.length-1?(a=Math.floor((new Date).getTime()/1e3)-t.date,void(a>h&&(p=e,d=0,m=!0,h=a))):(a=allConsumptions[e+1].date-t.date,void(a>h&&(p=e,d=e+1,h=a)))});var g,f=new Date(1e3*allConsumptions[p].date).toISOString().slice(0,16).replace(/T/," ").replace(":","")+' (<a href="/experience.html?'+allConsumptions[p].exp_id+'">'+allConsumptions[p].title+"</a>)";g=m?(new Date).toISOString().slice(0,16).replace(/T/," ").replace(":","")+" (present)":new Date(1e3*allConsumptions[d].date).toISOString().slice(0,16).replace(/T/," ").replace(":","")+' (<a href="/experience.html?'+allConsumptions[d].exp_id+'">'+allConsumptions[d].title+"</a>)";var y=Math.floor(h/86400);$("#tBreak").html(f+" to "+g+" ("+y+" days)"),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,drug;analyticsCount+=1;