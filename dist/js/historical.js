"use strict";function startHistorical(){friends(),drugs(),basics(),experience_list(),hourly_daily_breakdown()}function dateToFormat(t){return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)}function parseUrlParam(t){return location.search.split(t+"=")[1].split("&")[0]}var drug,allDrugs,allConsumptions=[],allExperiences,analyticsCount=0,analyticsFinished=0,friends,drugs,basics,experience_list,hourly_daily_breakdown;if(0===location.search.length){var today=new Date,weekAgo=new Date((new Date).setDate((new Date).getDate()-7));window.location="/historical.html?start="+dateToFormat(weekAgo)+"&end="+dateToFormat(today)}else{var start=new Date(parseUrlParam("start")).getTime()/1e3,end=new Date(parseUrlParam("end")).getTime()/1e3;$(".start").html(parseUrlParam("start")),$(".end").html(parseUrlParam("end")),makeAuthRequest("/experience/search","POST",JSON.stringify({startdate:start,enddate:end}),"json",function(t,e,a){return t?($("#noCon").show(),$("#cons").hide(),void $("#loading").hide()):(allExperiences=e,e.forEach(function(t){t.consumptions.forEach(function(e){e.expTitle=t.title,allConsumptions.push(e)})}),void startHistorical())})}var updateInterval=setInterval(function(){$("#historicalComplete").text(Math.round(analyticsFinished/analyticsCount*100)),$("#historicalProgress").css("width",Math.round(analyticsFinished/analyticsCount*100)+"%"),analyticsFinished===analyticsCount&&(clearInterval(updateInterval),setTimeout(function(){$("#loading").hide(),$("#cons").show()},500))},100);