"use strict";function alphabetizeSort(a,e){return a=a.toLowerCase(),e=e.toLowerCase(),e>a?-1:a>e?1:0}function populateDropdown(a){a=a||0,$("#drugList").empty(),$("#deleteDrug").hide(),$("#drugList").append('<option value="0">New Drug</option>'),makeAuthRequest("/drug/all","GET",null,"json",function(e,t,i){t.sort(function(a,e){return alphabetizeSort(a.name,e.name)}),drugs=t,t.forEach(function(e){var t="";a===e.id&&(t="selected "),$("#drugList").append("<option "+t+'value="'+e.id+'">'+e.name+" ("+e.unit+")</option>")}),$("#drugList").trigger("change")})}function saveNew(){var a={name:$("#name").val(),unit:$("#unit").val(),notes:$("#notes").val(),classification:$("#classification").val(),family:$("#family").val(),rarity:$("#rarity").val()};makeAuthRequest("/drug","POST",JSON.stringify(a),"json",function(a,e,t){return 201!==t?void Materialize.toast("Drug save error: "+a,6e3,"warning-toast"):(populateDropdown(e.id),void Materialize.toast("Drug created",1e3))})}function deleteDrug(){makeAuthRequest("/drug","DELETE",JSON.stringify({id:parseInt($("#drugList").val())}),"json",function(a,e,t){return 200!==t?void Materialize.toast("Drug delete error: "+a,6e3,"warning-toast"):(populateDropdown(0),void Materialize.toast("Drug deleted",1e3))})}var drugs,saveNotificationTimeout;$(document).ready(function(){location.search.slice(1)>0?populateDropdown(Number(location.search.slice(1))):populateDropdown()}),$("#drugList").on("change",function(){return 0===parseInt($("#drugList").val())?($("#name").val(""),$("#unit").val(""),$("#classification").val(""),$("#family").val(""),$("#rarity").val(1),$("#notes").val(""),$("#saveNew").show(),void $("#deleteDrug").hide()):($("#saveNew").hide(),$("#deleteDrug").show(),void drugs.forEach(function(a){a.id===parseInt($("#drugList").val())&&($("#name").val(a.name),$("#unit").val(a.unit),$("#classification").val(a.classification),$("#family").val(a.family),$("#rarity").val(a.rarity),$("#notes").val(a.notes),$("#nameLabel, #unitLabel, #classificationLabel, #familyLabel, #notesLabel").addClass("active"),$("#notes").trigger("autoresize"),$("#notesMarkdown").html(cleanMarkdown(micromarkdown.parse($("#notes").val()))),$("#notes").hide(),$("#notesMarkdown").show())}))}),$("#name, #unit, #classification, #family, #rarity, #notes").on("change keyup paste",function(){0!==parseInt($("#drugList").val())&&(clearTimeout(saveNotificationTimeout),saveNotificationTimeout=setTimeout(function(){var a={id:parseInt($("#drugList").val()),name:$("#name").val(),unit:$("#unit").val(),notes:$("#notes").val(),classification:$("#classification").val(),family:$("#family").val(),rarity:$("#rarity").val()};makeAuthRequest("/drug","PUT",JSON.stringify(a),"json",function(a,e,t){return 200!==t?void Materialize.toast("Drug save error: "+a,6e3,"warning-toast"):void Materialize.toast("Drug saved",1e3)})},1e3))}),$("#notesMarkdown").on("click",function(){$("#notesMarkdown").hide(),$("#notes").show(),$("#notesLabel").show()});