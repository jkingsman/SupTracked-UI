"use strict";function loadMore(){atEnd||(atEnd=!0,makeAuthRequest("/media/search","POST",JSON.stringify({limit:batchSize,offset:currentBatch*batchSize}),"json",function(e,i,a){404!==a&&i.length===batchSize?currentBatch+=1:atEnd=!0,i.forEach(function(e,i){i%4===0&&$("#media").append('<div id="row'+Math.floor(i/4)+'" class="row"></div>');var a=(getCookie("server")+"/media/file/"+e.id,"");"experience"===e.association_type&&(a='<br><a href="/experience.html?'+e.association+'">View Experience</a>'),$("#row"+Math.floor(i/4)).append('<div class="col s12 m3"><div class="card"><div class="card-image"><a id="imagelink'+e.id+'"><img id="image'+e.id+'"/><span class="card-title">'+e.title+'</span><a/></div><div class="card-content"><p>'+new Date(1e3*e.date).toISOString().slice(5,16).replace(/T/," ").replace("-","/")+a+"</p></div></div></div>"),makeAuthBlobRequest("/media/file/"+e.id,function(i){var a=window.URL||window.webkitURL;$("#image"+e.id).attr("src",a.createObjectURL(i)),$("#imagelink"+e.id).attr("href",a.createObjectURL(i))})}),$("#loading").hide(),$("#media").show()}))}function newMedia(){$("#addMediaModal").openModal()}var currentBatch=0,batchSize=24,atEnd=!1;makeAuthRequest("/media/search","POST",null,"json",function(e,i,a){404===a&&($("#loading").hide(),$("#emptyMedia").show())}),loadMore(),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-50&&loadMore()});