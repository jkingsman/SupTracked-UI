function basics(){"use strict";$("#totals").html(allConsumptions.length+" consumptions in "+allExperiences.length+" experiences");var n=allExperiences.map(function(n){return{id:n.id,title:n.title,count:n.consumptions.length}}).sort(function(n,t){return n.count<t.count});$("#mostCon").html(n[0].count+' in <a href="/experience.html?'+n[0].id+'">'+n[0].title+"</a>"),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences;analyticsCount+=1;
function calendar(){"use strict";var a=new Date(parseUrlParam("start")),t=new Date(parseUrlParam("end"));a.setDate(a.getDate()+1),t.setDate(t.getDate()+1),0!==a.getDay()&&a.setDate(a.getDate()-a.getDay());for(var e=1,r=0;t>=a;)7===e&&(e=0,r+=1),1===e&&$("#calendar").append('<div class="row" id="calendarRow'+r+'"</div>'),$("#calendarRow"+r).append('<div class="col s12 m2 col'+e+'" style="min-height: 100px; border: 1px solid rgb(0, 0, 0);"><strong>'+dateToFormat(a)+'</strong><hr><ul style="margin-left: 15px; list-style-type: disc !important;" id="'+dateToFormat(a)+'"></ul></div>'),e+=1,a.setDate(a.getDate()+1);var n={};allConsumptions.forEach(function(a){var t=dateToFormat(new Date(1e3*a.date)),e=t+"--"+a.drug.id;n.hasOwnProperty(e)?n[e]=n[e]+a.count:n[e]=Number(a.count)});for(var s in n)if(n.hasOwnProperty(s)){var l=s.split("--"),i=n[s],o=allDrugs[l[1]];$("#"+l[0]).append("<li>"+i+" "+o.unit+" "+o.name+"</li>")}analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences,dateToFormat,parseUrlParam,allDrugs;analyticsCount+=1;
function drugs(){"use strict";var n=[];allConsumptions.forEach(function(u){n.hasOwnProperty(u.drug.name)?(n[u.drug.name].count+=u.count,n[u.drug.name].number+=1):(n[u.drug.name]={},n[u.drug.name].count=u.count,n[u.drug.name].number=1,n[u.drug.name].unit=u.drug.unit)});var u=[];for(var t in n)n.hasOwnProperty(t)&&u.push({count:n[t].count,unit:n[t].unit,number:n[t].number,name:t});var r=u.sort(function(n,u){return u.number-n.number}).map(function(n){return n.count+" "+n.unit+" ("+n.number+" consumptions) of "+n.name}),a='<ul class="pad-left-40"><li>'+r.join("</li><li>")+"</li></ul>";$("#totalCons").html(a),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences;analyticsCount+=1;
function drug_info(){"use strict";var n=[],r=[],a=[];allConsumptions.forEach(function(t){n.push(allDrugs[t.drug.id].classification),r.push(allDrugs[t.drug.id].family),a[allDrugs[t.drug.id].rarity]=a[allDrugs[t.drug.id].rarity]+1||1});var t=[],i=[];n.forEach(function(n){t[n]=t[n]+1||1});var s=[];for(var o in t)t.hasOwnProperty(o)&&s.push({name:o,count:t[o]});var u=s.sort(function(n,r){return r.count-n.count}).map(function(n){return"<strong>"+n.name+"</strong>:"+n.count+" ("+Math.round(n.count/allConsumptions.length*100)+"%)"}),e="<ul>"+u.join("</li><li>")+"</li>";$("#classifications").html(e),r.forEach(function(n){i[n]=i[n]+1||1});var l=[];for(var p in i)i.hasOwnProperty(p)&&l.push({name:p,count:i[p]});var c=l.sort(function(n,r){return r.count-n.count}).map(function(n){return"<strong>"+n.name+"</strong>: "+n.count+" ("+Math.round(n.count/allConsumptions.length*100)+"%)"}),d="<ul>"+c.join("</li><li>")+"</li>";$("#families").html(d),$("#rarities").append('<span class="blue white-text" style="padding: 3px; border-radius: 24px;">Very Common</span> -- '+("-"|a[0])+"<br><br>"),$("#rarities").append('<span class="green white-text" style="padding: 3px; border-radius: 24px;">Common</span> -- '+("-"|a[1])+"<br><br>"),$("#rarities").append('<span class="purple white-text" style="padding: 3px; border-radius: 24px;">Uncommon</span> -- '+("-"|a[2])+"<br><br>"),$("#rarities").append('<span class="red white-text" style="padding: 3px; border-radius: 24px;">Rare</span> -- '+("-"|a[3])+"<br><br>"),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences;analyticsCount+=1;
function experience_list(){"use strict";allExperiences.forEach(function(n){n.title.length<1&&(n.title="[none]");var e=collateConsumptions(n.consumptions),i=[];if(Object.keys(e).length>0)for(var t in e)i.push(e[t].count+" "+e[t].unit+" "+t);else i.push("no consumptions");var o=[],s="Solo Experience";n.consumptions.forEach(function(n){n.friends.forEach(function(n){-1===o.indexOf(n.name)&&o.push(n.name)})}),o.length>0&&(s=o.join(", "));var a=[],l="[no location]";n.consumptions.forEach(function(n){-1===a.indexOf(n.location)&&a.push(n.location)}),a.length>0&&(l=a.join(", ")),$("#experiences-collection").append('<li class="collection-item">'+new Date(1e3*n.date).toISOString().slice(0,10)+'<span class="right hide-on-med-and-down" style="max-width: 50%;">'+s+" at <strong>"+l+'</strong></span><h5><a href="/experience.html?'+n.id+'">'+n.title+'</a></h5><div class="pad-left-40">'+i.join("<br />")+"</div></li>")}),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences;analyticsCount+=1;
function friends(){"use strict";var n=[];allConsumptions.forEach(function(o){return 0===o.friends.length?void(n.hasOwnProperty("Solo")?n.Solo=n.Solo+1:n.Solo=1):void o.friends.forEach(function(o){n.hasOwnProperty(o.name)?n[o.name]=n[o.name]+1:n[o.name]=1})});var o=[];for(var t in n)n.hasOwnProperty(t)&&o.push({name:t,count:n[t]});var a=o.sort(function(n,o){return o.count-n.count}).map(function(n){return n.count+" ("+Math.round(n.count/allConsumptions.length*100)+"%) with "+n.name}),i='<ul class="pad-left-40">'+a.join("</li><li>")+"</li>";$("#friends").html(i),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences;analyticsCount+=1;
function hourly_daily_breakdown(){"use strict";for(var t=[],o=0;23>=o;o+=1)t[o]=0;var n=6e4*(new Date).getTimezoneOffset();allConsumptions.forEach(function(o){var e=new Date(1e3*o.date+n),a=e.getHours();t[a]+=1}),$("#hourly").highcharts({chart:{type:"column"},title:{text:"Consumptions by Hour from "+$("#start").text()+" to "+$("#end").text()},xAxis:{categories:["0000 - 0100","0100 - 0200","0200 - 0300","0300 - 0400","0400 - 0500","0500 - 0600","0600 - 0700","0700 - 0800","0800 - 0900","0900 - 1000","1000 - 1100","1100 - 1200","1200 - 1300","1300 - 1400","1400 - 1500","1500 - 1600","1600 - 1700","1700 - 1800","1800 - 1900","1900 - 2000","2000 - 2100","2100 - 2200","2200 - 2300","2300 - 0000"],crosshair:!0},yAxis:{min:0,title:{text:"Consumptions"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}: </span>',pointFormat:"<b>{point.y} consumptions</b>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Consumptions",data:t}]});var e=[];for(o=0;6>=o;o+=1)e[o]=0;allConsumptions.forEach(function(t){var o=new Date(1e3*t.date+n),a=o.getDay();e[a]+=1}),$("#daily").highcharts({chart:{type:"column"},title:{text:"Consumptions by Day from "+$("#start").text()+" to "+$("#end").text()},xAxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],crosshair:!0},yAxis:{min:0,title:{text:"Consumptions"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}: </span>',pointFormat:"<b>{point.y} consumptions</b>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Consumptions",data:e}]}),setTimeout(function(){$("#daily").highcharts().reflow(),$("#hourly").highcharts().reflow()},2e3),analyticsFinished+=1}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences;analyticsCount+=1;
function media(){"use strict";makeAuthRequest("/media/search","POST",JSON.stringify({startdate:start,enddate:end}),"json",function(e,a,i){if(e)return void(analyticsFinished+=1);var t=0;a.forEach(function(e,i){i%6===0&&($("#media").append('<div id="row'+t+'" class="row"></div>'),t+=1);var s=(getCookie("server")+"/media/file/"+e.id,"");"experience"===e.association_type&&(s='<br><a href="/experience.html?'+e.association+'">View Experience ('+e.exp_title+")</a>");var r="";e.explicit&&(r='style="-webkit-filter: blur(15px); filter: blur(15px);"');var n="";e.favorite&&(n='<i class="material-icons" style="color: gold;">thumb_up</i>');var l="<br>[no tags]";e.tags&&(l="<br>"+e.tags),$("#row"+(t-1)).append('<div class="col s12 m2"><div class="card"><div class="card-image"><a id="imagelink'+e.id+'" target="_blank"><img id="image'+e.id+'" '+r+'><span class="card-title" id="title-'+e.id+'" style="background-color: rgba(0, 0, 0, 0.5);">'+n+e.title+'</span><a/></div><div class="card-content"><p>'+new Date(1e3*e.date).toISOString().slice(5,16).replace(/T/," ").replace("-","/")+'<span id="tags-'+e.id+'">'+l+"</span>"+s+"</p></div></div></div>"),makeAuthBlobRequest("/media/file/"+e.id,function(a){var i=new FileReader;i.onload=function(a){var i=a.target.result.replace("application/octet-stream","image/png");$("#image"+e.id).attr("src",i),$("#imagelink"+e.id).attr("href",i)},i.readAsDataURL(a)}),i===a.length-1&&(analyticsFinished+=1)})})}var analyticsCount,analyticsFinished,allDrugs,allConsumptions,allExperiences,start,end,getCookie,makeAuthBlobRequest;analyticsCount+=1;