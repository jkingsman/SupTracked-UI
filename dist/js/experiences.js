"use strict";function loadMore(){atEnd||makeAuthRequest("/experience/search","POST",JSON.stringify({limit:batchSize,offset:currentBatch*batchSize}),"json",function(e,n,t){404!==t&&n.length===batchSize?currentBatch+=1:atEnd=!0,n.forEach(function(e){e.title.length<1&&(e.title="[none]");var n={};e.consumptions.forEach(function(e){n.hasOwnProperty(e.drug.name)?n[e.drug.name].count+=e.count:(n[e.drug.name]={},n[e.drug.name].count=e.count,n[e.drug.name].unit=e.drug.unit)});var t=[];if(Object.keys(n).length>0)for(var i in n)t.push(n[i].count+" "+n[i].unit+" "+i);else t.push("no consumptions");$("#experiences-collection").append('<li class="collection-item">'+new Date(1e3*e.date).toISOString().slice(0,10)+'<h5><a href="/experience.html?'+e.id+'">'+e.title+'</a></h5><div class="pad-left-40">'+t.join("<br />")+"</div></li>")}),$("#loading").hide(),$("#experiences").show()})}var currentBatch=0,batchSize=30,atEnd=!1;makeAuthRequest("/experience/search","POST",null,"json",function(e,n,t){404===t&&($("#loading").hide(),$("#emptyExperiences").show())}),loadMore(),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-50&&loadMore()});