"use strict";function drugSelected(){switch($("#drug").val().indexOf("dup")>-1&&$("#drug").val($("#drug").val().split("-")[1]),allDrugs.forEach(function(t){return t.id===parseInt($("#drug").val())?(location.search.length<1&&(location.search=t.id),void(drug=t)):void 0}),document.title=drug.name.substr(0,1).toUpperCase()+drug.name.substr(1)+" | SupTracked",$(".drugName").text(drug.name),$("#unit").html(drug.unit),$("#classification").html(drug.classification),$("#family").html(drug.family),parseInt(drug.rarity)){case 0:$("#rarity").html('<span class="blue white-text" style="padding: 3px; border-radius: 24px;">Very Common</span>');break;case 1:$("#rarity").html('<span class="green white-text" style="padding: 3px; border-radius: 24px;">Common</span>');break;case 2:$("#rarity").html('<span class="purple white-text" style="padding: 3px; border-radius: 24px;">Uncommon</span>');break;case 3:$("#rarity").html('<span class="red white-text" style="padding: 3px; border-radius: 24px;">Rare</span>');break;default:$("#rarity").html('<span class="grey white-text" style="padding: 3px; border-radius: 24px;">???</span>')}$("#notes").html(cleanMarkdown(micromarkdown.parse(drug.notes.split("$$$purchasedata$$$")[0]))),makeAuthRequest("/consumption/search","POST",JSON.stringify({drug_id:drug.id}),"json",function(t,a,n){allExperiences=a,a?(a.forEach(function(t){t.consumptions.forEach(function(a){a.drug.id===drug.id&&(a.title=t.title,a.exp_id=t.id,allConsumptions.push(a))})}),allConsumptions.sort(function(t,a){return t.date<a.date?-1:t.date>a.date?1:0}),$("#drugEntry").attr("href","/drugs.html?"+drug.id),startAnalytics()):($("#selection").hide(),$("#none").show(),analyticsFinished=analyticsCount)})}function startAnalytics(){vitals(),experience_list(),top_listings(),hours_days(),purchasing()}var drug,allDrugs,allConsumptions=[],allExperiences,analyticsCount=0,analyticsFinished=0,vitals,experience_list,top_listings,hours_days,purchasing,autoStart,countdown=5,updateInterval,hasSelected=!1;updateInterval=setInterval(function(){var t=100*Math.round(analyticsFinished/analyticsCount);$("#analyticsComplete").text(t+"%"),$("#analyticsProgress").css("width",t+"%"),(analyticsFinished===analyticsCount||window.location.hash.substring(1).indexOf("skip")>-1)&&setTimeout(function(){clearInterval(updateInterval),$("#loading").hide(),$("#analytics").show()},500)},100),makeAuthRequest("/drug/all","GET",null,"json",function(t,a,n){if(a.length<1)return void $("#none").show();allDrugs=a.sort(function(t,a){return t=t.name.toLowerCase(),a=a.name.toLowerCase(),a>t?-1:t>a?1:0});var e=allDrugs.slice();e=e.sort(function(t,a){return a.use_count-t.use_count}).slice(0,5),$("#drug").append('<optgroup label="Common" id="common_dropdwngroup"></optgroup>'),e.forEach(function(t,a,n){$("#common_dropdwngroup").append('<option value="'+t.id+'">'+t.name+" ("+t.unit+")</option>"),n[a]=t.id}),$("#drug").append('<optgroup label="All" id="all_dropdwngroup"></optgroup>'),allDrugs.forEach(function(t){-1===e.indexOf(t.id)?$("#all_dropdwngroup").append('<option value="'+t.id+'">'+t.name+" ("+t.unit+")</option>"):$("#all_dropdwngroup").append('<option value="dup-'+t.id+'">'+t.name+" ("+t.unit+")</option>")});var r=allDrugs.map(function(t){return t.id});location.search.length>1&&r.indexOf(Number(location.search.substr(1)))>-1?($("#drug").val(location.search.substr(1)),drugSelected()):($("#drug").val(e[0]),drugSelected())}),$("#drug").change(function(){drugSelected()});